#!/bin/bash
#
#
#
#
#
#Blah first run, about, menu.
#
## Load libkeyrng
. libkeyrng
## Check if it is the first run.
FIRST_RUN=$(ls gpg-KeyRNG | grep -c "secring")
  if [ "$FIRST_RUN" -lt "1" ]; then
      clear
      firstrun
  fi
## What now?
PS3='Please enter your choice: '
options=("Key Management" "Encryption" "Quit")
select opt in "${options[@]}"
do
    case $opt in
        "Key Management")
            PS3='Please enter your choice: '
            options=("Generate New Keypair" "See/Export Public Key(s)" "See/Export Secret Key(s)" "Send Keys To Keyserver" "Receive Keys From Keyserver" "Quit")
            select opt in "${options[@]}"
            do
                case $opt in
                    "Generate New Keypair")
                        genkey
                        ;;
                    "See/Export Public Key(s)")
                        PS3='Please enter your choice: '
                        options=("List Public Keys By UID" "List Full Public Keys" "Export A Public Key To Terminal" "Export A Public Key To File" "Quit")
                        select opt in "${options[@]}"
                        do
                            case $opt in
                                "List Public Keys By UID")
                                listkeyuids
                                ;;
                                "List Full Public Keys")
                                listfullkeydetails
                                ;;
                                "Export A Public Key To Terminal")
                                exportpubkey
                                ;;
                                "Export A Public Key To File")
                                exportpubkeyfile
                                ;;
                                "Quit")
                                echo "Press enter TWICE! to return to Key Management menu."
                                read
                                break
                                ;;
                                *) echo "Invalid Option";;
                            esac
                        done
                    "See/Export Secret Key(s)")
                        ;;
                    "Send Keys To Keyserver")
                        ;;
                    "Receive Keys From Keyserver")
                        ;;
                    "Quit")
                        echo "Press enter TWICE! to return to main menu."
                        read
                        break
                        ;;
                    *) echo "Invalid option";;
                esac
            done
            ;;
        "Encryption")
            encryptfile
            ;;
        "Quit")
            break
            ;;
        *) echo "Invalid option";;
    esac
done
